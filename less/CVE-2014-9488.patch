--- less-474/charset.c  2015-01-31 00:20:28.000000000 +0100
+++ less-475/charset.c  2015-05-02 22:08:38.000000000 +0200
@@ -506,8 +506,9 @@
  * Does the parameter point to the lead byte of a well-formed UTF-8 character?
  */
    public int
-is_utf8_well_formed(s)
+is_utf8_well_formed(s, slen)
    unsigned char *s;
+   int slen;
 {
    int i;
    int len;
@@ -516,6 +517,8 @@
        return (0);
 
    len = utf_len((char) s[0]);
+   if (len > slen)
+       return (0);
    if (len == 1)
        return (1);
    if (len == 2)
@@ -547,7 +550,7 @@
    int bin_count = 0;
    while (len > 0)
    {
-       if (is_utf8_well_formed(data))
+       if (is_utf8_well_formed(data, len))
        {
            int clen = utf_len(*data);
            data += clen;